!function(e){var t={};function o(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=t,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(i,n,function(t){return e[t]}.bind(null,n));return i},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=3)}([function(e,t){e.exports="<div id=\"div-contenedor\" class=\"m-control m-container m-munpanel\">\n    <div id='buscador-panel'>\n        <div id='buscador-panel-title'>Buscador de Municipios</div>\n        <div id='buscador-panel-body'>\n            <div id='content-panel'>\n                <h3 class='tituloSelect'>Provincias</h3>\n                <select name='provincias' id='selectProvincias'>\n                    <option class='opProvincias' value='Select' disabled='disabled' selected>Selecciona una\n                        provincia</option>\n                    <option class='opProvincias' value='Almeria'>Almería</option>\n                    <option class='opProvincias' value='Cadiz'>Cádiz</option>\n                    <option class='opProvincias' value='Cordoba'>Córdoba</option>\n                    <option class='opProvincias' value='Granada'>Granada</option>\n                    <option class='opProvincias' value='Huelva'>Huelva</option>\n                    <option class='opProvincias' value='Jaen'>Jaén</option>\n                    <option class='opProvincias' value='Malaga'>Málaga</option>\n                    <option class='opProvincias' value='Sevilla'>Sevilla</option>\n                    <option class='opProvincias' value='Todas'>Todas</option>\n                </select>\n                <h3 class='tituloSelect'>Municipios</h3>\n                <select name='municipios' id='selectMunicipios'>\n                    <option class='opMunicipios' value='Select' disabled='disabled' selected>Selecciona un\n                        municipio</option>\n\n                </select>\n                \n                <hr>\n                <h3 class='tituloSelect'>Datos de Población</h3>\n                <select name='poblacion' id='selectPoblacion'>\n                    <option class='opPoblacion' value='' selected></option>\n                    <option class='opPoblacion' value='2020'>2020</option>\n                    <option class='opPoblacion' value='2019'>2019</option>\n                    <option class='opPoblacion' value='2018'>2018</option>\n                    <option class='opPoblacion' value='2017'>2017</option>\n                    <option class='opPoblacion' value='2016'>2016</option>\n                    <option class='opPoblacion' value='2015'>2015</option>\n                    <option class='opPoblacion' value='2014'>2014</option>\n                    <option class='opPoblacion' value='2013'>2013</option>\n                    <option class='opPoblacion' value='2012'>2012</option>\n                    <option class='opPoblacion' value='2011'>2011</option>\n                    <option class='opPoblacion' value='2010'>2010</option>\n                    <option class='opPoblacion' value='2009'>2009</option>\n                    <option class='opPoblacion' value='2008'>2008</option>\n                    <option class='opPoblacion' value='2007'>2007</option>\n                    <option class='opPoblacion' value='2006'>2006</option>\n                    <option class='opPoblacion' value='2005'>2005</option>\n                    <option class='opPoblacion' value='2004'>2004</option>\n                    <option class='opPoblacion' value='2003'>2003</option>\n                    <option class='opPoblacion' value='2002'>2002</option>\n                    <option class='opPoblacion' value='2001'>2001</option>\n                    <option class='opPoblacion' value='2000'>2000</option>\n                    <option class='opPoblacion' value='1999'>1999</option>\n                    <option class='opPoblacion' value='1998'>1998</option>\n                    <option class='opPoblacion' value='1996'>1996</option>\n                </select>\n                \n                <div id='divSuperavit'>\n                    <label><input type=\"checkbox\" id=\"checkSuperavit\" value=\"Superavit\">\n                        Superávit/Déficit último ejercicio</label>\n                </div>\n                \n                \n                <h3 class='tituloSelect' id='tituloSS'>Afiliación Seg. Social</h3>\n                <select name='regimenAfiliacion' id='selectRegimenAfiliacion'>\n                    <option class='opRegimenAfiliacion' value='' selected></option>\n                    <option class='opRegimenAfiliacion' value='Régimen General* y Carbón'>Régimen General y Carbón\n                    </option>\n                    <option class='opRegimenAfiliacion' value='Sistema Especial Agrario'>Sistema Especial Agrario\n                    </option>\n                    <option class='opRegimenAfiliacion' value='Régimen Especial Trabajadores Autónomos'>Régimen Especial\n                        Trabajadores Autónomos</option>\n                    <option class='opRegimenAfiliacion' value='Régimen Especial del Mar'>Régimen Especial del Mar\n                    </option>\n                    <option class='opRegimenAfiliacion'\n                        value='Régimen Especial Empleados del Hogar y R.G. Sistema Especial de Empleados del Hogar'>\n                        Régimen Especial y Sistema Especial de Empleados del Hogar</option>\n                </select>\n\n                <select name='sexoAfiliacion' id='selectSexoAfiliacion'>\n                    <option class='opSexoAfiliacion' value='' selected></option>\n                    <option class='opSexoAfiliacion' value='Hombres'>Hombres</option>\n                    <option class='opSexoAfiliacion' value='Mujeres'>Mujeres</option>\n                    <option class='opSexoAfiliacion' value='Ambos sexos'>Total</option>\n                    <option class='opSexoAfiliacion' value='Ambos sexos disgregados'>Ambos</option>\n                </select>\n                <p id='controlCarga'>Cargando datos</p>\n                <hr>\n\n                <h3 class='tituloSelect'>Buscador de Municipios</h3>\n                <form id='buscaMunicipio'>\n                    <label for='busMuni'>Municipio</label>\n                    <input type='text' id='busMuni' name='municipio' autocomplete='off'>\n                </form>\n                <div id='divBotones'>\n                    <button id='botonBusca' title='Busca un Municipio'>Busca</button>\n                    <button id='botonLimpia' title='Limpia campos'>Limpia</button>\n                </div>\n                <div id='DivTablaResultados'>\n                    <table id='TablaResultados' class='TablaOculta'>\n                        <thead>\n                            <tr>\n                                <td>MUNICIPIO</td>\n                                <td>PROVINCIA</td>\n                            </tr>\n                        </thead>\n                        <tbody>\n                        </tbody>\n                    </table>\n                </div>\n                <div id='controlTablas'>\n                    <button id='botonAtras' title='Anterior' class='g-cartografia-flecha-izquierda'></button>\n                    <button id='botonAvance' title='Siguiente' class='g-cartografia-flecha-derecha'></button>\n                </div>\n                <p id='paginado'>datos de busqueda</p>\n                <div id='resultadosBusqueda'>\n                    <p id='resulBus'>RESULTADO BUSQUEDA</p>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>"},function(e){e.exports=JSON.parse('{"url":{"name":"Munpanel","separator":"*"},"constructor":"M.plugin.Munpanel","parameters":[],"files":{"ol":{"scripts":[],"styles":[]}},"metadata":{"uuid_plugin":"","uuid_version_plugin":"","version_ficha_metadatos":"","name":"Munpanel","description":"Description of the plugin","text":"A full text about plugin","version":"1.0.0","date":"","author":"","org":"","tags":"mapea,plugin","icon":"./facade/assets/icons/icons.svg","buttons":[{"title":"","description":"","querySelector":""},{"title":"","description":"","querySelector":""}],"dependencies":{"modules":["",""],"plugins":[{"uuid":"","name":""}],"services":[{"name":"","description":""}]},"compatibility":["6.0.0"]}}')},function(e,t,o){},function(e,t,o){"use strict";o.r(t);o(2);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t,o){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,o){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(o):n.value}})(e,t,o||e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,i=u(e);if(t){var n=u(this).constructor;o=Reflect.construct(i,arguments,n)}else o=i.apply(this,arguments);return r(this,o)}}function r(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(p,M.impl.Control);var t,o,i,r=l(p);function p(){return n(this,p),r.apply(this,arguments)}return t=p,(o=[{key:"addTo",value:function(e,t){var o=this;e.getMapImpl().getInteractions().forEach((function(e){e instanceof ol.interaction.DoubleClickZoom&&(o.dblClickInteraction_=e)})),s(u(p.prototype),"addTo",this).call(this,e,t)}},{key:"activateClick",value:function(e){this.dblClickInteraction_.setActive(!1),e.getMapImpl().on("dblclick",(function(t){var o=new CustomEvent("mapclicked",{detail:t.coordinate,bubbles:!0});e.getContainer().dispatchEvent(o)}))}},{key:"deactivateClick",value:function(e){this.dblClickInteraction_.setActive(!0),e.getMapImpl().removeEventListener("dblclick")}}])&&a(t.prototype,o),i&&a(t,i),p}(),f=o(0),d=o.n(f);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function h(e,t,o){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,o){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=S(e)););return e}(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(o):n.value}})(e,t,o||e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,i=S(e);if(t){var n=S(this).constructor;o=Reflect.construct(i,arguments,n)}else o=i.apply(this,arguments);return b(this,o)}}function b(e,t){if(t&&("object"===g(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(a,M.Control);var t,o,i,n=v(a);function a(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),M.utils.isUndefined(p)&&M.exception("La implementación usada no puede crear controles MunpanelControl");var o=new p;return(t=n.call(this,o,"Munpanel")).config=e,t}return t=a,(o=[{key:"createView",value:function(e){var t=this;return new Promise((function(e,o){var i=M.template.compileSync(d.a);t.addEvents(i),e(i)}))}},{key:"addEvents",value:function(e){var t=this,o=e.querySelectorAll("select#selectProvincias")[0],i=e.querySelectorAll("select#selectMunicipios")[0],n=e.querySelectorAll("form#buscaMunicipio")[0],a=e.querySelectorAll("button#botonBusca")[0],s=e.querySelectorAll("button#botonLimpia")[0],c=e.querySelectorAll("button#botonAtras")[0],l=e.querySelectorAll("button#botonAvance")[0],r=e.querySelectorAll("table#TablaResultados")[0],u=e.querySelectorAll("select#selectPoblacion")[0],p=e.querySelectorAll("select#selectRegimenAfiliacion")[0],f=e.querySelectorAll("select#selectSexoAfiliacion")[0],d=e.querySelectorAll("input#checkSuperavit")[0];this.map_.on(M.evt.COMPLETED,(function(){o.addEventListener("change",(function(){var e=o.value;t.limpia(),t.muestraProvincia(e)})),i.addEventListener("change",(function(){var e=o.value,n=i.value;t.seleccionaMunicipio(e,n)})),u.addEventListener("change",(function(){""!=t.config.selectedFeature&&t.map_.getFeatureHandler().unselectFeatures([t.config.selectedFeature],t.config.selectedProv,{}),t.map_.getPopup()&&t.map_.removePopup();for(var e=0;e<t.config.layerList.length;e++)t.config.layerList[e].setStyle(t.config.styleList[e]);f.style.marginBottom="0px",t.config.stAnterior=!1,t.config.munAnterior=!1,i.item(0).selected="selected",""!=u.value?(t.config.status.opcPoblacion="false",document.getElementById("controlCarga").style.display="block",t.config.pobYear=u.value,t.consultaPoblacion(t.config.pobYear)):(t.config.status.opcPoblacion="true",document.getElementById("selectSexoAfiliacion").style.marginBottom="27px",t.config.pobYear=u.value)})),p.addEventListener("change",(function(){""!=t.config.selectedFeature&&t.map_.getFeatureHandler().unselectFeatures([t.config.selectedFeature],t.config.selectedProv,{}),t.map_.getPopup()&&t.map_.removePopup();for(var e=0;e<t.config.layerList.length;e++)t.config.layerList[e].setStyle(t.config.styleList[e]);""!=p.value?(f.style.marginBottom="0px",document.getElementById("controlCarga").style.display="block",f.item(1).selected="selected"):f.item(0).selected="selected",""!=p.value&&""!=f.value?t.config.status.opcSegsocial="false":t.config.status.opcSegsocial="true",t.config.ssRegimen=p.value,t.config.ssSexo=f.value,t.config.listSegsocial=[],t.consultaSegSocial(t.config.ssRegimen,t.config.ssSexo)})),f.addEventListener("change",(function(){""!=t.config.selectedFeature&&t.map_.getFeatureHandler().unselectFeatures([t.config.selectedFeature],t.config.selectedProv,{}),t.map_.getPopup()&&t.map_.removePopup();for(var e=0;e<t.config.layerList.length;e++)t.config.layerList[e].setStyle(t.config.styleList[e]);""!=f.value?(f.style.marginBottom="0px",document.getElementById("controlCarga").style.display="block",p.item(1).selected="selected"):p.item(0).selected="selected",""!=p.value&&""!=f.value?t.config.status.opcSegsocial="false":t.config.status.opcSegsocial="true",t.config.ssRegimen=p.value,t.config.ssSexo=f.value,t.config.listSegsocial=[],t.consultaSegSocial(t.config.ssRegimen,t.config.ssSexo)})),d.addEventListener("change",(function(){""!=t.config.selectedFeature&&t.map_.getFeatureHandler().unselectFeatures([t.config.selectedFeature],t.config.selectedProv,{}),t.map_.getPopup()&&t.map_.removePopup();for(var e=0;e<t.config.layerList.length;e++)t.config.layerList[e].setStyle(t.config.styleList[e]);d.checked?(f.style.marginBottom="0px",document.getElementById("controlCarga").style.display="block",t.config.status.opcSuperavit=!0,t.consultaSuperavit()):t.config.status.opcSuperavit=!1})),n.addEventListener("keydown",(function(e){t.muestraBotones(),13===e.keyCode&&document.getElementById("botonBusca").focus()})),a.addEventListener("click",(function(){t.listaMunicipios()})),s.addEventListener("click",(function(){t.limpia()})),c.addEventListener("click",(function(){t.retrocedeTabla()})),l.addEventListener("click",(function(){t.avanzaTabla()})),r.addEventListener("click",(function(e){var o=e.target.parentElement.rowIndex,i=document.getElementById("TablaResultados").rows[o].cells[0].innerText,n=document.getElementById("TablaResultados").rows[o].cells[1].innerText;t.muestraProvincia(n),t.buscaMunicipio(i,n)}));for(var e=function(e){t.config.layerList[e].on(M.evt.SELECT_FEATURES,(function(o){o[0]instanceof M.ClusteredFeature||(0!=t.config.munAnterior&&t.config.munAnterior.setStyle(t.config.stAnterior),t.config.selectedFeature=o[0],t.config.selectedProv=t.config.layerList[e],t.config.munAnterior=t.config.selectedFeature,t.config.stAnterior=t.config.munAnterior.getStyle(),document.getElementById("paginado").style.display="none",t.borraTablas(),t.config.pag=0,t.config.reg=0,t.config.result=[],document.getElementById("busMuni").value="",document.getElementById("divBotones").style.display="none",document.getElementById("resultadosBusqueda").style.display="none",document.getElementById("controlTablas").style.display="none",document.getElementById("resulBus").innerHTML="",document.getElementById("selectMunicipios").options.item(0).selected="selected",t.config.provinciaSeleccionada=t.quitaAcentos(o[0].getAttribute("provincia")),t.config.munSelect=o[0].getAttribute("nombre"),t.seleccionaMunicipio(t.config.provinciaSeleccionada,t.config.munSelect),"Select"==document.querySelectorAll("select#selectProvincias")[0].value&&(document.querySelectorAll("select#selectProvincias")[0].value="Todas",t.creaSelect("Todas"),t.cambiaSelect(t.config.munSelect)))}))},g=0;g<t.config.layerList.length;g++)e(g)}))}},{key:"activate",value:function(){h(S(a.prototype),"activate",this).call(this)}},{key:"deactivate",value:function(){h(S(a.prototype),"deactivate",this).call(this)}},{key:"getActivationButton",value:function(e){return e.querySelector(".m-munpanel button")}},{key:"equals",value:function(e){return e instanceof a}},{key:"muestraProvincia",value:function(e){this.map_.getPopup()&&this.map_.removePopup();var t=this.map_.getLayers().length-9;if(this.map_.getLayers().length>9)for(var o=0;o<t;o++){var i=this.map_.getLayers()[8];this.map_.removeLayers(i),this.config.layerList[o].setStyle(this.config.styleList[o])}for(var n=0;n<document.getElementById("selectProvincias").options.length;n++)document.getElementById("selectProvincias").options[n].value==e&&(this.config.provinciaSeleccionada=document.getElementById("selectProvincias").options[n].value,document.getElementById("selectProvincias").options[n].selected="selected",this.creaSelect(e));for(var a=0;a<this.config.layerList.length;a++)if("Todas"!=e)this.config.layerList[a].getImpl().name==e&&(this.map_.addLayers(this.config.layerList[a]),this.map_.setBbox(this.config.layerList[a].getMaxExtent()));else for(var s=0;s<this.config.layerList.length;s++)this.map_.addLayers(this.config.layerList[a]),this.map_.setBbox(this.map_.getMaxExtent());""!=document.getElementById("selectPoblacion").value&&this.representaPoblacion()}},{key:"creaSelect",value:function(e){for(var t=document.querySelectorAll(".opMunicipios"),o=document.querySelectorAll(".opMunicipiosProv"),i=document.getElementById("selectMunicipios"),n=document.createElement("option"),a=document.createTextNode("Selecciona un municipio"),s=0;s<t.length;s++)i.removeChild(t[s]);for(var c=0;c<o.length;c++)i.removeChild(o[c]);if((n=document.createElement("option")).setAttribute("value","Select"),n.setAttribute("class","opMunicipios"),n.setAttribute("disabled","disabled"),n.setAttribute("selected","selected"),a=document.createTextNode("Selecciona un municipio"),n.appendChild(a),i.appendChild(n),"Todas"!=e){for(var l=0;l<this.config.layerList.length;l++)if(e==this.config.layerList[l].getImpl().name)for(var r=0;r<this.config.layerList[l].getFeatures().length;r++)(n=document.createElement("option")).setAttribute("value",this.config.layerList[l].getFeatures()[r].impl_.olFeature_.values_.nombre),n.setAttribute("class","opMunicipios"),a=document.createTextNode(this.config.layerList[l].getFeatures()[r].impl_.olFeature_.values_.nombre),n.appendChild(a),i.appendChild(n)}else for(var u=0;u<this.config.layerList.length;u++){(n=document.createElement("option")).setAttribute("value",this.config.layerList[u].getImpl().name),n.setAttribute("class","opMunicipiosProv"),n.setAttribute("disabled","disabled"),a=document.createTextNode("          ------"+this.config.layerList[u].getImpl().name.toUpperCase()+"------"),n.appendChild(a),i.appendChild(n);for(var p=0;p<this.config.layerList[u].getFeatures().length;p++)(n=document.createElement("option")).setAttribute("value",this.config.layerList[u].getFeatures()[p].impl_.olFeature_.values_.nombre),n.setAttribute("class","opMunicipios"),a=document.createTextNode(this.config.layerList[u].getFeatures()[p].impl_.olFeature_.values_.nombre),n.appendChild(a),i.appendChild(n)}i.value="Select"}},{key:"seleccionaMunicipio",value:function(e,t){this.map_.getPopup()&&this.map_.removePopup();var o=!0;this.config.status.opcPoblacion&&(this.config.status.stPoblacion||(o=!1)),this.config.status.opcSuperavit&&(this.config.status.stSuperavit||(o=!1)),this.config.status.opcSegsocial&&(this.config.status.stSegsocial||(o=!1)),o&&this.buscaMunicipio(t,e)}},{key:"buscaMunicipio",value:function(e,t){for(var o,i=!1,n=0;n<this.config.listPoblacion.length;n++)this.config.listPoblacion[n]==e&&(this.config.pobSelect=this.config.listPoblacion[n+1]+" hab.",i=!0);(0==i||this.config.pobSelect.length<6)&&(this.config.pobSelect="---"),i=!1;for(var a=0;a<this.config.listSuperavit.length;a++)this.config.listSuperavit[a]==e&&(this.config.superavit=new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(this.config.listSuperavit[a+1]),i=!0);if((0==i||this.config.superavit.length<3)&&(this.config.superavit="---"),i=!1,"Hombres"==this.config.ssSexo){for(var s=0;s<this.config.listSegsocial.length;s++)this.config.listSegsocial[s]==e&&(this.config.ssHombres=this.config.listSegsocial[s+1],i=!0);0==i&&(this.config.ssHombres="---")}if("Mujeres"==this.config.ssSexo){for(var c=0;c<this.config.listSegsocial.length;c++)this.config.listSegsocial[c]==e&&(this.config.ssMujeres=this.config.listSegsocial[c+1],i=!0);0==i&&(this.config.ssMujeres="---")}if("Ambos sexos"==this.config.ssSexo){for(var l=0;l<this.config.listSegsocial.length;l++)this.config.listSegsocial[l]==e&&(this.config.ssAmbos=this.config.listSegsocial[l+1],i=!0);0==i&&(this.config.ssAmbos="---")}if("Ambos sexos disgregados"==this.config.ssSexo){for(var r=0;r<this.config.listSegsocial.length;r++)this.config.listSegsocial[r]==e&&(this.config.ssHombres=this.config.listSegsocial[r+1],this.config.ssMujeres=this.config.listSegsocial[r+2],this.config.ssAmbos=this.config.listSegsocial[r+3],i=!0);0==i&&(this.config.ssHombres="---",this.config.ssMujeres="---",this.config.ssAmbos="---")}for(var u=0;u<this.config.layerList.length;u++)if(this.config.layerList[u].getImpl().name==t||"Todas"==t)for(var p=0;p<this.config.layerList[u].getFeatures().length;p++)if(this.config.layerList[u].getFeatures()[p].getImpl().getAttribute("nombre")==e){o=this.config.layerList[u].getFeatures()[p],this.config.munSelect=e,0!=this.config.munAnterior&&this.config.munAnterior.setStyle(this.config.stAnterior),this.config.selectedFeature=o,this.config.selectedProv=this.config.layerList[u],this.config.munAnterior=o,this.config.stAnterior=o.getStyle(),o.setStyle(new M.style.Polygon({fill:{color:"#8d8d8d",opacity:.5},stroke:{color:"#ff0000",width:3}}));var f=this.createPopupFeature(this.centroide(o));f[2].addTab(this.popupTabContent(t,o)),this.addPopupFeature(f[2],f[0],f[1]),this.map_.setCenter({x:this.centroide(o)[0],y:this.centroide(o)[1],draw:!1}),this.cambiaSelect(e)}}},{key:"createPopupFeature",value:function(e){return[e,this.map_.getZoom(),new M.Popup]}},{key:"addPopupFeature",value:function(e,t,o){var i=this;this.map_.addPopup(e,t),this.map_.setZoom(o),document.querySelectorAll("div.m-content")[0].className="pop_feat",document.querySelectorAll("a.m-popup-closer")[0].addEventListener("click",(function(){i.config.munAnterior.setStyle(i.config.stAnterior),document.querySelectorAll("select#selectMunicipios")[0].value="Select",i.map_.getFeatureHandler().unselectFeatures([i.config.selectedFeature],i.config.selectedProv,{}),i.config.selectedFeature="",i.config.selectedProv=""}))}},{key:"popupTabContent",value:function(e,t){var o=t.getAttribute("nombre"),i=t.getAttribute("cod_mun"),n=this.superficieMunicipio(t)[0],a=this.superficieMunicipio(t)[1],s="---",c="",l="",r="";return"---"!=this.config.pobSelect&&(s=(s=(parseFloat(this.config.pobSelect)/n).toFixed(2)).replace(".",",")+" hab./Km²"),"Hombres"==this.config.ssSexo&&(c='<table class="list_feat"><caption>Afiliación Seg. Social '+this.config.ssYear+'</caption><tr><th colspan="2">'+this.config.ssRegimen.replace("*","")+"</th></tr><tr><th>Hombres</th><td>"+this.config.ssHombres+"</td></tr></table>"),"Mujeres"==this.config.ssSexo&&(c='<table class="list_feat"><caption>Afiliación Seg. Social '+this.config.ssYear+'</caption><tr><th colspan="2">'+this.config.ssRegimen.replace("*","")+"</th></tr><tr><th>Mujeres</th><td>"+this.config.ssMujeres+"</td></tr></table>"),"Ambos sexos"==this.config.ssSexo&&(c='<table class="list_feat"><caption>Afiliación Seg. Social '+this.config.ssYear+'</caption><tr><th colspan="2">'+this.config.ssRegimen.replace("*","")+"</th></tr><tr><th>Ambos sexos</th><td>"+this.config.ssAmbos+"</td></tr></table>"),"Ambos sexos disgregados"==this.config.ssSexo&&(c='<table class="list_feat"><caption>Afiliación Seg. Social '+this.config.ssYear+'</caption><tr><th colspan="2">'+this.config.ssRegimen.replace("*","")+"</th></tr><tr><th>Hombres</th><td>"+this.config.ssHombres+"</td></tr><tr><th>Mujeres</th><td>"+this.config.ssMujeres+"</td></tr><tr><th>Ambos sexos</th><td>"+this.config.ssAmbos+"</td></tr></table>"),""!=this.config.pobYear&&(l="<tr><th>Población año "+this.config.pobYear+" </th><td>"+this.config.pobSelect+"</td></tr><tr><th>Densidad de población año "+this.config.pobYear+" </th><td>"+s+"</td></tr><tr></tr>"),this.config.status.opcSuperavit&&(r="<tr><th>Superávit/Déficit <br> último ejercicio</th><td>"+this.config.superavit+"</td></tr>"),{icon:"g-cartografia-pin",title:"Municipio de "+e,content:'<div style="text-align: center"><table class="list_feat"><tr><th> Nombre </th><td>'+o+"</td></tr><tr><th>Codigo municipio </th><td>"+i+"</td></tr><tr><th>Superficie</th><td>"+n+" Km²</td></tr></tr><tr><th>Perímetro</th><td>"+a+" Km</td></tr>"+l+"</td></tr>"+r+"</table>"+c+"</div>"}}},{key:"centroide",value:function(e){for(var t=[0,0],o=[],i=0;i<e.getGeometry().coordinates.length;i++)for(var n=0;n<e.getGeometry().coordinates[i][0].length-1;n++)o=o.concat(e.getGeometry().coordinates[i][0][n]);for(var a=0;a<o.length/2;a++)t[0]=t[0]+o[2*a],t[1]=t[1]+o[2*a+1];return t[0]=t[0]/(o.length/2),t[1]=t[1]/(o.length/2),t}},{key:"superficieMunicipio",value:function(e){for(var t=0,o=0,i=0;i<e.getGeometry().coordinates.length;i++){for(var n=[],a=0;a<e.getGeometry().coordinates[i][0].length;a++)n=n.concat(e.getGeometry().coordinates[i][0][a]);for(var s=0;s<n.length/2-1;s++)t=t+(n[2*s+2]-n[2*s])*n[2*s+1]+(n[2*s+2]-n[2*s])*(n[2*s+3]-n[2*s+1])/2,o+=Math.sqrt((n[2*s+2]-n[2*s])*(n[2*s+2]-n[2*s])+(n[2*s+3]-n[2*s+1])*(n[2*s+3]-n[2*s+1]))}return[t=(t=Math.round(t)/1e6).toFixed(2),o=(o=Math.round(o)/1e3).toFixed(2)]}},{key:"cambiaSelect",value:function(e){for(var t=0;t<document.getElementById("selectMunicipios").length;t++)document.getElementById("selectMunicipios").options[t].innerText==e&&(document.getElementById("selectMunicipios").options.item(t).selected="selected")}},{key:"muestraBotones",value:function(){document.getElementById("divBotones").style.display="flex"}},{key:"listaMunicipios",value:function(){this.borraTablas();var e=document.getElementById("busMuni").value,t=e,o=!1;document.getElementById("resultadosBusqueda").style.display="none",document.getElementById("resulBus").innerHTML="",this.config.provinciaSeleccionada=document.getElementById("selectProvincias").value,document.getElementById("DivTablaResultados").style.display="block",e=e.toLowerCase();for(var i=(e=this.quitaAcentos(e)).split(" "),n=0;n<i.length;n++)"de"!=i[n]&&"del"!=i[n]&&"la"!=i[n]&&"los"!=i[n]&&"las"!=i[n]&&(i[n]=i[n][0].toUpperCase()+i[n].slice(1));e="";for(var a=0;a<i.length;a++)e+=i[a],a<i.length-1&&(e+=" ");i=(e=e[0].toUpperCase()+e.slice(1)).split(" ");for(var s=0;s<i.length;s++)"de"!=i[s]&&"del"!=i[s]&&"la"!=i[s]&&"los"!=i[s]&&"las"!=i[s]||i[s].splice(s,1);for(var c=0;c<i.length;c++)for(var l=0;l<this.config.layerList.length;l++)if("Select"==this.config.provinciaSeleccionada||"Todas"==this.config.provinciaSeleccionada||this.config.provinciaSeleccionada==this.config.layerList[l].getImpl().name)for(var r=0;r<this.config.layerList[l].getFeatures().length;r++){var u=this.config.layerList[l].getFeatures()[r].getImpl().getAttribute("nombre");(u=this.quitaAcentos(u)).includes(i[c])&&(this.config.result[2*this.config.reg]=this.config.layerList[l].getFeatures()[r].getImpl().getAttribute("nombre"),this.config.result[2*this.config.reg+1]=this.config.layerList[l].getImpl().name,this.config.reg=this.config.reg+1,o=!0)}this.config.pag=0,this.config.numeroTablas=parseInt(this.config.reg/this.config.num_results)+1,this.creaTabla(),this.config.reg>15&&(document.getElementById("controlTablas").style.display="flex",document.getElementById("botonAvance").style.display="flex",document.getElementById("botonAtras").style.display="none"),0==o&&(document.getElementById("DivTablaResultados").style.display="none",document.getElementById("resultadosBusqueda").style.display="block",document.getElementById("paginado").style.display="none","Todas"!=this.config.provinciaSeleccionada&&"Select"!=this.config.provinciaSeleccionada?document.getElementById("resulBus").innerHTML='"'+t+'" no muestra ningún resultado en la lista de municipios de '+this.config.provinciaSeleccionada:document.getElementById("resulBus").innerHTML='"'+t+'" no muestra ningún resultado en la lista de municipios')}},{key:"borraTablas",value:function(){document.getElementById("TablaResultados").innerHTML="<thead><tr><td>MUNICIPIO</td><td>PROVINCIA</td></tr></thead><tbody></tbody>",document.getElementById("TablaResultados").className="TablaOculta"}},{key:"quitaAcentos",value:function(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace("á","a")).replace("é","e")).replace("í","i")).replace("ó","o")).replace("ú","u")).replace("Á","A")).replace("É","E")).replace("Í","I")).replace("Ó","O")).replace("Ú","U")}},{key:"creaTabla",value:function(){for(var e=this.config.pag*this.config.num_results;e<this.config.pag*this.config.num_results+this.config.num_results;e++)e<this.config.reg&&(document.getElementById("TablaResultados").getElementsByTagName("tbody")[0].insertRow(-1).innerHTML="<tr><th>"+this.config.result[2*e]+"</th><th>"+this.config.result[2*e+1]+"</th></tr>");document.getElementById("TablaResultados").className="TablaResultados",document.getElementById("paginado").style.display="block",this.config.pag*this.config.num_results+this.config.num_results<this.config.reg?document.getElementById("paginado").innerHTML="Resultados "+(this.config.pag*this.config.num_results+1)+" a "+(this.config.pag*this.config.num_results+this.config.num_results)+" de "+this.config.reg:document.getElementById("paginado").innerHTML="Resultados "+(this.config.pag*this.config.num_results+1)+" a "+this.config.reg+" de "+this.config.reg}},{key:"retrocedeTabla",value:function(){this.config.pag>0&&(this.config.pag=this.config.pag-1,this.borraTablas(),this.creaTabla()),0==this.config.pag&&(document.getElementById("botonAtras").style.display="none"),this.config.pag==this.config.numeroTablas-2&&(document.getElementById("botonAvance").style.display="flex")}},{key:"avanzaTabla",value:function(){this.config.pag<this.config.numeroTablas-1&&(this.config.pag=this.config.pag+1,this.borraTablas(),this.creaTabla()),this.config.pag==this.config.numeroTablas-1&&(document.getElementById("botonAvance").style.display="none"),1==this.config.pag&&(document.getElementById("botonAtras").style.display="flex")}},{key:"limpia",value:function(){if(document.getElementById("busMuni").value="",document.getElementById("divBotones").style.display="none",document.getElementById("resultadosBusqueda").style.display="none",document.getElementById("controlTablas").style.display="none",document.getElementById("resulBus").innerHTML="",document.getElementById("selectMunicipios").options.item(0).selected="selected",document.getElementById("paginado").style.display="none",this.map_.getPopup()&&this.map_.removePopup(),""==document.getElementById("selectPoblacion").value)for(var e=0;e<this.config.layerList.length;e++)this.config.layerList[e].setStyle(this.config.styleList[e]);""!=document.getElementById("selectPoblacion").value&&this.representaPoblacion(),this.borraTablas();var t=this.map_.getLayers().length-9;if("Select"!=this.config.provinciaSeleccionada&&"Todas"!=this.config.provinciaSeleccionada&&this.map_.getLayers().length>9)for(var o=0;o<t;o++){var i=this.map_.getLayers()[8];this.config.provinciaSeleccionada!=i.impl_.name&&this.map_.removeLayers(i)}this.config.pag=0,this.config.reg=0,this.config.result=[]}},{key:"normalizaMunicipio",value:function(e){for(var t=0;t<e.length;t++)-1!==e[t].indexOf("(El)")&&(e[t]="El "+e[t].slice(0,e[t].indexOf(" (El)"))),-1!==e[t].indexOf("(Los)")&&(e[t]="Los "+e[t].slice(0,e[t].indexOf(" (Los)"))),-1!==e[t].indexOf("(La)")&&(e[t]="La "+e[t].slice(0,e[t].indexOf(" (La)"))),-1!==e[t].indexOf("(Las)")&&(e[t]="Las "+e[t].slice(0,e[t].indexOf(" (Las)"))),-1!==e[t].indexOf("(capital)")&&(e[t]=e[t].slice(0,e[t].indexOf(" (capital)")));return e}},{key:"consultaPoblacion",value:function(e){var t=this;this.config.status.stPoblacion=!1;var o=new XMLHttpRequest;o.open("GET","https://www.ieca.junta-andalucia.es/intranet/admin/rest/v1.0/consulta/6780"),o.responseType="json",o.send(),o.onload=function(){for(var i=o.response,n=0,a=0;a<i.data.length;a++)i.data[a][1].des==e&&(t.config.listPoblacion[2*n]=i.data[a][0].des,t.config.listPoblacion[2*n+1]=i.data[a][3].format,n+=1);t.config.listPoblacion=t.normalizaMunicipio(t.config.listPoblacion),200==o.status&&(document.getElementById("selectSexoAfiliacion").style.marginBottom="27px",document.getElementById("controlCarga").style.display="none",t.representaPoblacion(),t.config.status.stPoblacion=!0),o.abort()}}},{key:"consultaSuperavit",value:function(){var e=this;this.config.status.stSuperavit=!1;var t=new XMLHttpRequest;t.open("GET","https://www.ieca.junta-andalucia.es/intranet/admin/rest/v1.0/consulta/1342"),t.responseType="json",t.send(),t.onload=function(){for(var o=t.response,i=0;i<o.data.length;i++)e.config.listSuperavit[2*i]=o.data[i][0].des,e.config.listSuperavit[2*i+1]=parseFloat(o.data[i][2].val).toFixed(2);e.config.listSuperavit=e.normalizaMunicipio(e.config.listSuperavit),200==t.status&&(document.getElementById("selectSexoAfiliacion").style.marginBottom="27px",document.getElementById("controlCarga").style.display="none",e.config.status.stSuperavit=!0),t.abort()}}},{key:"consultaSegSocial",value:function(e,t){var o=this;this.config.status.stSegsocial=!1;var i=new XMLHttpRequest;i.open("GET","https://www.ieca.junta-andalucia.es/intranet/admin/rest/v1.0/consulta/49400"),i.responseType="json",i.send(),i.onload=function(){var n=i.response,a=0;if(o.config.ssYear=n.data[0][3].des,document.getElementById("tituloSS").innerHTML="Afiliación Seg. Social "+o.config.ssYear,"Ambos sexos disgregados"!=t)for(var s=0;s<n.data.length;s++)n.data[s][1].des==e&&n.data[s][2].des==t&&(o.config.listSegsocial[2*a]=n.data[s][0].des,"*"!=n.data[s][4].format&&""!=n.data[s][4].format&&(o.config.listSegsocial[2*a+1]=n.data[s][4].format),"*"==n.data[s][4].format&&(o.config.listSegsocial[2*a+1]="< 5"),""==n.data[s][4].format&&(o.config.listSegsocial[2*a+1]="---"),a+=1);if("Ambos sexos disgregados"==t){a=0;for(var c=0;c<n.data.length;c++)n.data[c][1].des==e&&"Hombres"==n.data[c][2].des&&(o.config.listSegsocial[a]=n.data[c][0].des,a+=1,o.config.listSegsocial[a]=n.data[c][4].format,"*"==o.config.listSegsocial[a]&&(o.config.listSegsocial[a]="< 5"),""==o.config.listSegsocial[a]&&(o.config.listSegsocial[a]="---"),a+=1,o.config.listSegsocial[a]=n.data[c+1][4].format,"*"==o.config.listSegsocial[a]&&(o.config.listSegsocial[a]="< 5"),""==o.config.listSegsocial[a]&&(o.config.listSegsocial[a]="---"),a+=1,o.config.listSegsocial[a]=n.data[c+2][4].format,"*"==o.config.listSegsocial[a]&&(o.config.listSegsocial[a]="< 5"),""==o.config.listSegsocial[a]&&(o.config.listSegsocial[a]="---"),a+=1)}o.config.listSegsocial=o.normalizaMunicipio(o.config.listSegsocial),200==i.status&&(document.getElementById("selectSexoAfiliacion").style.marginBottom="27px",document.getElementById("controlCarga").style.display="none",o.config.status.stSegsocial=!0),i.abort()}}},{key:"representaPoblacion",value:function(){for(var e=0;e<this.config.layerList.length;e++)for(var t=0;t<this.config.layerList[e].getFeatures().length;t++){this.config.layerList[e].getFeatures()[t].setStyle(new M.style.Polygon({fill:{color:"#ecdede",opacity:.8},stroke:{color:"#0c0c0c",width:1}}));for(var o=0;o<this.config.listPoblacion.length;o+=2)if(this.config.layerList[e].getFeatures()[t].getAttribute("nombre")==this.config.listPoblacion[o]){var i=Number(this.config.listPoblacion[o+1].replace(".",""));i<=1e3&&this.config.layerList[e].getFeatures()[t].setStyle(new M.style.Polygon({fill:{color:"#ecdede",opacity:.8},stroke:{color:"#0c0c0c",width:1}})),i>1e3&&i<=5e3&&this.config.layerList[e].getFeatures()[t].setStyle(new M.style.Polygon({fill:{color:"#cf9f9f",opacity:.8},stroke:{color:"#0c0c0c",width:1}})),i>5e3&&i<=1e4&&this.config.layerList[e].getFeatures()[t].setStyle(new M.style.Polygon({fill:{color:"#e67777",opacity:.8},stroke:{color:"#0c0c0c",width:1}})),i>1e4&&i<=5e4&&this.config.layerList[e].getFeatures()[t].setStyle(new M.style.Polygon({fill:{color:"#ac4747",opacity:.8},stroke:{color:"#0c0c0c",width:1}})),i>5e4&&i<=1e5&&this.config.layerList[e].getFeatures()[t].setStyle(new M.style.Polygon({fill:{color:"#d62929",opacity:.8},stroke:{color:"#0c0c0c",width:1}})),i>1e5&&this.config.layerList[e].getFeatures()[t].setStyle(new M.style.Polygon({fill:{color:"#ff0000",opacity:.8},stroke:{color:"#0c0c0c",width:1}}))}}}}])&&m(t.prototype,o),i&&m(t,i),a}(),E=o(1);function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function L(e,t){return(L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,i=x(e);if(t){var n=x(this).constructor;o=Reflect.construct(i,arguments,n)}else o=i.apply(this,arguments);return w(this,o)}}function w(e,t){if(t&&("object"===A(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}(a,M.Plugin);var t,o,i,n=B(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=n.call(this)).map_=null,t.config=e,t.controls_=[],t.metadata_=E.metadata,t}return t=a,(o=[{key:"addTo",value:function(e){this.controls_.push(new P(this.config)),this.controls_.push(this.control_),this.map_=e,this.panel_=new M.ui.Panel("panelMunpanel",{collapsible:!0,className:"m-munpanel",position:M.ui.position.TR,collapsedButtonClass:"g-cartografia-prismaticos"}),this.panel_.addControls(this.controls_),e.addPanels(this.panel_)}},{key:"getMetadata",value:function(){return this.metadata_}}])&&_(t.prototype,o),i&&_(t,i),a}();window.M.plugin||(window.M.plugin={}),window.M.control||(window.M.control={}),window.M.impl||(window.M.impl={}),window.M.impl.control||(window.M.impl.control={}),window.M.plugin.Munpanel=I,window.M.control.MunpanelControl=P,window.M.impl.control.MunpanelControl=p}]);
//# sourceMappingURL=munpanel.ol.min.js.map